<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Eldritch Horror Card Clerk+</title>
		<link rel="stylesheet" href="css/index.css" />
		<link rel="stylesheet" href="css/logic-operator.css" />
		<link rel="stylesheet" href="css/mythos-grid.css" />
		<link rel="stylesheet" href="libraries/Dragula/dragula.min.css" />
		<!-- Data -->
		<script src="js/global_variables.js"></script>
		<script src="js/data_expansion.js"></script>
		<script src="js/data_mythos.js"></script>
		<script src="js/data_artifact.js"></script>
		<script src="js/data_non_unique_asset.js"></script>
		<script src="js/data_condition.js"></script>
		<script src="js/data_investigator.js"></script>
		<script src="js/data_monster.js"></script>
		<script src="js/data_spell.js"></script>
		<script src="js/data_unique_asset.js"></script>
		<script src="js/data_ancient_one.js"></script>
		<!-- Logic -->
		<script src="js/deck.js"></script>
		<script src="js/index.js"></script>
		<script src="js/mythos-grid.js"></script>
		<script src="js/utilities.js"></script>
		<script src="js/session.js"></script>
	</head>
	<body>
		<h1>ELDRITCH&nbsp;HORROR CARD&nbsp;CLERK+</h1>

		<div id="startView" class="view start-view">
			<button id="loadGameButton" type="button" onclick="loadGame()">Load Last Session</button>
			<button id="newGameButton" type="button" onclick="startNewGame()">New Game</button>
			<div>Your progress is automatically saved as you interact with the website.</div>
			<div id="expansions" class="expansions"></div>
		</div>
		<div id="mainView" class="view">
			<fieldset class="deck-visibility">
				<div class="section__name">Toggle Deck Visibility</div>
				<div class="section__decks"></div>
			</fieldset>

			<fieldset class="deck mythos-composition">
				<div class="deck__name">Mythos Deck Composition</div>
				<label for="ancientOne">Preset: </label>
				<select name="ancientOne" onchange="settingPreset(event)"></select>
				<br />
				<label>
					<input type="checkbox" class="toggle-advance-composition" onclick="toggleMythosGrid(this.checked)" />Use Advanced Composition Mode
				</label>
				<form class="mythos-grid-form">
					<div class="mythos-grid mythos-grid-simple">
						<div class="mythos-stage">Starting Rumor:</div>
						<div></div>
						<div></div>
						<input type="number" min="0" class="mythos-blue" data-stage="0" data-color="blue" />
						<div class="mythos-stage">Stage I:</div>
						<input type="number" min="0" class="mythos-green" data-stage="1" data-color="green" />
						<input type="number" min="0" class="mythos-yellow" data-stage="1" data-color="yellow" />
						<input type="number" min="0" class="mythos-blue" data-stage="1" data-color="blue" />
						<div class="mythos-stage">Stage II:</div>
						<input type="number" min="0" class="mythos-green" data-stage="2" data-color="green" />
						<input type="number" min="0" class="mythos-yellow" data-stage="2" data-color="yellow" />
						<input type="number" min="0" class="mythos-blue" data-stage="2" data-color="blue" />
						<div class="mythos-stage">Stage III:</div>
						<input type="number" min="0" class="mythos-green" data-stage="3" data-color="green" />
						<input type="number" min="0" class="mythos-yellow" data-stage="3" data-color="yellow" />
						<input type="number" min="0" class="mythos-blue" data-stage="3" data-color="blue" />
					</div>
					<div class="mythos-grid mythos-grid-advanced">
						<div class="mythos-stage">Starting Rumor Easy:</div>
						<div></div>
						<div></div>
						<input type="number" min="0" class="mythos-blue" data-stage="0" data-color="blue" data-difficulty="easy" />
						<div class="mythos-stage">Starting Rumor Normal:</div>
						<div></div>
						<div></div>
						<input type="number" min="0" class="mythos-blue" data-stage="0" data-color="blue" data-difficulty="normal" />
						<div class="mythos-stage">Starting Rumor Hard:</div>
						<div></div>
						<div></div>
						<input type="number" min="0" class="mythos-blue" data-stage="0" data-color="blue" data-difficulty="hard" />
						<div class="mythos-stage new-stage">Stage I Easy:</div>
						<input type="number" min="0" class="mythos-green new-stage" data-stage="1" data-color="green" data-difficulty="easy" />
						<input type="number" min="0" class="mythos-yellow new-stage" data-stage="1" data-color="yellow" data-difficulty="easy" />
						<input type="number" min="0" class="mythos-blue new-stage" data-stage="1" data-color="blue" data-difficulty="easy" />
						<div class="mythos-stage" data-stage="1">Stage I Normal:</div>
						<input type="number" min="0" class="mythos-green" data-stage="1" data-color="green" data-difficulty="normal" />
						<input type="number" min="0" class="mythos-yellow" data-stage="1" data-color="yellow" data-difficulty="normal" />
						<input type="number" min="0" class="mythos-blue" data-stage="1" data-color="blue" data-difficulty="normal" />
						<div class="mythos-stage" data-stage="1">Stage I Hard:</div>
						<input type="number" min="0" class="mythos-green" data-stage="1" data-color="green" data-difficulty="hard" />
						<input type="number" min="0" class="mythos-yellow" data-stage="1" data-color="yellow" data-difficulty="hard" />
						<input type="number" min="0" class="mythos-blue" data-stage="1" data-color="blue" data-difficulty="hard" />
						<div class="mythos-stage new-stage">Stage II Easy:</div>
						<input type="number" min="0" class="mythos-green new-stage" data-stage="2" data-color="green" data-difficulty="easy" />
						<input type="number" min="0" class="mythos-yellow new-stage" data-stage="2" data-color="yellow" data-difficulty="easy" />
						<input type="number" min="0" class="mythos-blue new-stage" data-stage="2" data-color="blue" data-difficulty="easy" />
						<div class="mythos-stage" data-stage="2">Stage II Normal:</div>
						<input type="number" min="0" class="mythos-green" data-stage="2" data-color="green" data-difficulty="normal" />
						<input type="number" min="0" class="mythos-yellow" data-stage="2" data-color="yellow" data-difficulty="normal" />
						<input type="number" min="0" class="mythos-blue" data-stage="2" data-color="blue" data-difficulty="normal" />
						<div class="mythos-stage" data-stage="2">Stage II Hard:</div>
						<input type="number" min="0" class="mythos-green" data-stage="2" data-color="green" data-difficulty="hard" />
						<input type="number" min="0" class="mythos-yellow" data-stage="2" data-color="yellow" data-difficulty="hard" />
						<input type="number" min="0" class="mythos-blue" data-stage="2" data-color="blue" data-difficulty="hard" />
						<div class="mythos-stage new-stage">Stage III Easy:</div>
						<input type="number" min="0" class="mythos-green new-stage" data-stage="3" data-color="green" data-difficulty="easy" />
						<input type="number" min="0" class="mythos-yellow new-stage" data-stage="3" data-color="yellow" data-difficulty="easy" />
						<input type="number" min="0" class="mythos-blue new-stage" data-stage="3" data-color="blue" data-difficulty="easy" />
						<div class="mythos-stage" data-stage="3">Stage III Normal:</div>
						<input type="number" min="0" class="mythos-green" data-stage="3" data-color="green" data-difficulty="normal" />
						<input type="number" min="0" class="mythos-yellow" data-stage="3" data-color="yellow" data-difficulty="normal" />
						<input type="number" min="0" class="mythos-blue" data-stage="3" data-color="blue" data-difficulty="normal" />
						<div class="mythos-stage" data-stage="3">Stage III Hard:</div>
						<input type="number" min="0" class="mythos-green" data-stage="3" data-color="green" data-difficulty="hard" />
						<input type="number" min="0" class="mythos-yellow" data-stage="3" data-color="yellow" data-difficulty="hard" />
						<input type="number" min="0" class="mythos-blue" data-stage="3" data-color="blue" data-difficulty="hard" />
					</div>
					<button type="button" onclick="buildMythosDeck()">Build Mythos Deck</button>
					<button type="reset">Reset</button>
				</form>
				<div class="mythos-error"></div>
			</fieldset>

			<form class="deck mythos" name="Mythos">
				<fieldset>
					<div class="deck__name">Mythos</div>
					Deck count: <span class="deck__count">0</span>.
					<br />
					<button type="button" onclick="drawMythosCard()">Draw</button>
					<button type="button" onclick="shuffleMythosDeckAsync()">Shuffle</button>
					<button type="button" onclick="toggleMythosHistory()">Toggle History</button>
					<button type="button" onclick="toggleMythosDrawFromBox()">Toggle Drawing from the Box</button>

					<fieldset class="mythos-box" style="display: none">
						<legend>Drawing from the Box</legend>
						<div class="traits">
							<label class="trait">
								<input type="checkbox" name="traits" class="trait__value" value="Green" />
								<span class="trait__name">Green</span>
							</label>
							<label class="trait">
								<input type="checkbox" name="traits" class="trait__value" value="Yellow" />
								<span class="trait__name">Yellow</span>
							</label>
							<label class="trait">
								<input type="checkbox" name="traits" class="trait__value" value="Blue" />
								<span class="trait__name">Blue</span>
							</label>
							<label class="trait">
								<input type="checkbox" name="traits" class="trait__value" value="Easy" />
								<span class="trait__name">Easy</span>
							</label>
							<label class="trait">
								<input type="checkbox" name="traits" class="trait__value" value="Normal" />
								<span class="trait__name">Normal</span>
							</label>
							<label class="trait">
								<input type="checkbox" name="traits" class="trait__value" value="Hard" />
								<span class="trait__name">Hard</span>
							</label>
						</div>
						<button type="button" onclick="drawBoxMythosCard()">Draw from the Box</button>
						<div class="box-drawn" style="display: none">
							<div class="card box-card" onclick="revealBoxMythos()">Click to reveal</div>
							<button type="button" onclick="discardBoxMythos()">Discard</button>
							<button type="button" onclick="shuffleBoxMythosToDeckAsync()">Shuffle into the Mythos deck</button>
						</div>
					</fieldset>

					<div class="last-drawn-card">
						Last drawn:
						<div class="no-newest-card">Unable to draw.</div>
						<div class="newest-card"></div>
					</div>

					<div class="drawn-cards" style="display: none">
						History (from last drawn to first):
						<div class="history"></div>
					</div>
				</fieldset>
			</form>

			<div id="decks" class="decks"></div>

			<button id="back" class="back-button" type="button" onclick="backToMainView()">Back</button>
		</div>

		<footer>
			<a href="https://boardgamegeek.com/boardgame/146021/eldritch-horror">Eldritch Horror</a>
			is a tabletop board game published by
			<a href="https://www.fantasyflightgames.com/en/products/eldritch-horror/">Fantasy Flight Games,</a>
			who owns all Copyright to the material.
			<br />
			This website is based on
			<a href="https://boardgamegeek.com/thread/1730002/eldritch-horror-card-clerk">Eldritch Horror Card Clerk</a>
			by Magnus Rydin.
			<br />
			Have an issue or a feature idea? Log a ticket on GitHub
			<a href="https://github.com/metapone/eldritch-horror-card-clerk-plus/issues">here</a>
			or made a comment on BoardGameGeek
			<a href="https://boardgamegeek.com/thread/3186841/eh-card-clerk-plus-website">here</a>.
		</footer>

		<!-- Templates -->
		<template id="expansionItemTemplate">
			<label class="expansion">
				<input type="checkbox" name="expansions" class="expansion__checkbox" checked />
				<img class="expansion__image" height="33" />
				<div class="expansion__name"></div>
			</label>
		</template>

		<template id="deckItemTemplate">
			<form class="deck" deckIndex="">
				<fieldset>
					<div><span class="deck__name"></span><span class="deck__subtitle"></span></div>
					<input type="hidden" name="deckIndex" class="deck__index" />
					Deck count: <span class="deck__count"></span>.
					<br />
					<button type="submit" class="draw">Draw</button>
					<button type="button" class="shuffle">Shuffle</button>
					<button type="button" class="toggle-name-filter">Toggle Name Filter</button>
					<button type="button" class="toggle-trait-filter">Toggle Trait Filter</button>
					<button type="button" class="toggle-cost-filter">Toggle Cost Filter</button>
					<button type="button" class="toggle-history">Toggle History</button>
					<button type="button" class="toggle-rearrange-top">Toggle Darrell's Action</button>

					<fieldset class="rearrange-top" style="display: none">
						<legend>Rearrange Top Cards</legend>
						Drag to reorder. Topmost card of the deck is at the top of the list.
						<div class="top-cards"></div>
						<button type="button" class="rearrange-top-cards">Return cards to the deck</button>
					</fieldset>

					<div class="name-filter" style="display: none">
						Name:
						<input name="nameFilter" class="name-filter__input" />
						<datalist class="name-filter__suggestion"></datalist>
					</div>

					<div class="trait-filter" style="display: none">
						<div class="logic-operator-wrapper">
							Logic Operator:
							<label class="logic-operator">
								<input type="checkbox" name="isOr" />
								<div data-unchecked="AND" data-checked="OR" class="logic-operator__switch"></div>
							</label>
						</div>
						<div class="traits"></div>
					</div>

					<div class="cost-filter" style="display: none">Cost: <span class="costs"></span></div>

					<div class="last-drawn-card">
						Last drawn:
						<div class="no-newest-card">Unable to draw.</div>
						<div class="newest-card"></div>
					</div>

					<div class="drawn-cards" style="display: none">
						History (from last drawn to first):
						<div class="history"></div>
					</div>
				</fieldset>
			</form>
		</template>

		<template id="traitItemTemplate">
			<label class="trait">
				<input type="checkbox" name="traits" class="trait__value" />
				<span class="trait__name"></span>
			</label>
		</template>

		<template id="costItemTemplate">
			<label>
				<input type="checkbox" name="costs" class="cost__value" />
				<span class="cost__name"></span>
			</label>
		</template>

		<template id="cardItemTemplate">
			<div class="card card-history card-history--mythos">
				<div class="card__name"></div>
				<div class="card__traits"></div>
			</div>
		</template>

		<template id="lastDrawnCardItemTemplate">
			<div class="card last-drawn">
				<div class="last-drawn__name"></div>
				<div class="last-drawn__traits"></div>
			</div>
		</template>

		<template id="historyItemTemplate">
			<div class="card card-history">
				<div class="card__name"></div>
				<div class="card__traits"></div>
				<button type="button" class="card__shuffleIn"></button>
			</div>
		</template>

		<template id="deckVisibilityItemTemplate">
			<label class="deck-visibility-item">
				<input type="checkbox" class="deck-visibility-item__index" />
				<span class="deck-visibility-item__name"></span>
			</label>
		</template>

		<script src="js/index_postRender.js"></script>
		<script src="libraries/Dragula/dragula.min.js"></script>
		<script src="js/rearrange_top_cards.js"></script>
	</body>
</html>
